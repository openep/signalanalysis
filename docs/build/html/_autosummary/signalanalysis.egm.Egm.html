
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>signalanalysis.egm.Egm &#8212; signalanalysis 0.1 documentation</title>
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="signalanalysis.general" href="signalanalysis.general.html" />
    <link rel="prev" title="signalanalysis.egm" href="signalanalysis.egm.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="signalanalysis-egm-egm">
<h1>signalanalysis.egm.Egm<a class="headerlink" href="#signalanalysis-egm-egm" title="Permalink to this headline">¶</a></h1>
<dl class="py class">
<dt id="signalanalysis.egm.Egm">
<em class="property">class </em><code class="sig-prename descclassname">signalanalysis.egm.</code><code class="sig-name descname">Egm</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data_location_uni</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">data_location_bi</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>str<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#signalanalysis.egm.Egm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="../_autosummary_bak/signalanalysis.general.Signal.html#signalanalysis.general.Signal" title="signalanalysis.general.Signal"><code class="xref py py-class docutils literal notranslate"><span class="pre">signalanalysis.general.Signal</span></code></a></p>
<p>Base class for EGM data, inheriting from <a class="reference internal" href="../_autosummary_bak/signalanalysis.general.Signal.html#signalanalysis.general.Signal" title="signalanalysis.general.Signal"><code class="xref py py-class docutils literal notranslate"><span class="pre">signalanalysis.general.Signal</span></code></a></p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="../_autosummary_bak/signalanalysis.general.Signal.html#signalanalysis.general.Signal" title="signalanalysis.general.Signal"><code class="xref py py-class docutils literal notranslate"><span class="pre">signalanalysis.general.Signal</span></code></a></p>
</div>
<dl class="py method">
<dt id="signalanalysis.egm.Egm.read">
<code class="sig-name descname">read</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">folder</span></em><span class="sig-paren">)</span><a class="headerlink" href="#signalanalysis.egm.Egm.read" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract data from unipolar and bipolar DxL files</p>
</dd></dl>

<dl class="py method">
<dt id="signalanalysis.egm.Egm.get_n_beats">
<code class="sig-name descname">get_n_beats</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#signalanalysis.egm.Egm.get_n_beats" title="Permalink to this definition">¶</a></dt>
<dd><p>Supersedes generalised method to calculate n_beats</p>
</dd></dl>

<dl class="py method">
<dt id="signalanalysis.egm.Egm.get_at">
<code class="sig-name descname">get_at</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#signalanalysis.egm.Egm.get_at" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the activation time of the EGM</p>
</dd></dl>

<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="../_autosummary_bak/signalanalysis.egm.Egm.html#signalanalysis.egm.Egm.apply_filter" title="signalanalysis.egm.Egm.apply_filter"><code class="xref py py-obj docutils literal notranslate"><span class="pre">apply_filter</span></code></a></p></td>
<td><p>Apply a given filter to the data, using their respective arguments as required</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../_autosummary_bak/signalanalysis.egm.Egm.html#signalanalysis.egm.Egm.calculate_dvdt" title="signalanalysis.egm.Egm.calculate_dvdt"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calculate_dvdt</span></code></a></p></td>
<td><p>Return dV/dt values at specified time points</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../_autosummary_bak/signalanalysis.egm.Egm.html#signalanalysis.egm.Egm.get_ari" title="signalanalysis.egm.Egm.get_ari"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_ari</span></code></a></p></td>
<td><p>Dummy function to calculate ARI</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../_autosummary_bak/signalanalysis.egm.Egm.html#id0" title="signalanalysis.egm.Egm.get_at"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_at</span></code></a></p></td>
<td><p>Calculates the activation time for a given beat of EGM data</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../_autosummary_bak/signalanalysis.egm.Egm.html#signalanalysis.egm.Egm.get_beats" title="signalanalysis.egm.Egm.get_beats"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_beats</span></code></a></p></td>
<td><p>Detects beats in individual EGM signals</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../_autosummary_bak/signalanalysis.egm.Egm.html#signalanalysis.egm.Egm.get_peaks" title="signalanalysis.egm.Egm.get_peaks"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_peaks</span></code></a></p></td>
<td><p>Supermethod for get_peaks for EGM data, using the squared bipolar signal rather than RMS data</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../_autosummary_bak/signalanalysis.egm.Egm.html#signalanalysis.egm.Egm.get_qrsd" title="signalanalysis.egm.Egm.get_qrsd"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_qrsd</span></code></a></p></td>
<td><p>Calculates the QRS duration for EGM data</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../_autosummary_bak/signalanalysis.egm.Egm.html#signalanalysis.egm.Egm.get_rms" title="signalanalysis.egm.Egm.get_rms"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_rms</span></code></a></p></td>
<td><p>Returns the RMS of the combined signal</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../_autosummary_bak/signalanalysis.egm.Egm.html#signalanalysis.egm.Egm.get_rt" title="signalanalysis.egm.Egm.get_rt"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_rt</span></code></a></p></td>
<td><p>Calculate the repolarisation time</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_twave_end</span></code></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../_autosummary_bak/signalanalysis.egm.Egm.html#signalanalysis.egm.Egm.plot_beats" title="signalanalysis.egm.Egm.plot_beats"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot_beats</span></code></a></p></td>
<td><p>..deprecated.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot_peaks</span></code></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../_autosummary_bak/signalanalysis.egm.Egm.html#id4" title="signalanalysis.egm.Egm.read"><code class="xref py py-obj docutils literal notranslate"><span class="pre">read</span></code></a></p></td>
<td><p>Read the DxL data for unipolar and bipolar data for EGMs</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../_autosummary_bak/signalanalysis.egm.Egm.html#signalanalysis.egm.Egm.read_from_csv" title="signalanalysis.egm.Egm.read_from_csv"><code class="xref py py-obj docutils literal notranslate"><span class="pre">read_from_csv</span></code></a></p></td>
<td><p>Read EGM data that has been saved from Matlab</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../_autosummary_bak/signalanalysis.egm.Egm.html#signalanalysis.egm.Egm.reset" title="signalanalysis.egm.Egm.reset"><code class="xref py py-obj docutils literal notranslate"><span class="pre">reset</span></code></a></p></td>
<td><p>Reset all properties of the class</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../_autosummary_bak/signalanalysis.egm.Egm.html#signalanalysis.egm.Egm.return_to_index" title="signalanalysis.egm.Egm.return_to_index"><code class="xref py py-obj docutils literal notranslate"><span class="pre">return_to_index</span></code></a></p></td>
<td><p>Aligns a given sequence of time values to those in the index</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt id="signalanalysis.egm.Egm.apply_filter">
<code class="sig-name descname">apply_filter</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#signalanalysis.egm.Egm.apply_filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply a given filter to the data, using their respective arguments as required</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="../_autosummary_bak/tools.maths.filter_butterworth.html#tools.maths.filter_butterworth" title="tools.maths.filter_butterworth"><code class="xref py py-meth docutils literal notranslate"><span class="pre">tools.maths.filter_butterworth()</span></code></a></dt><dd><p>Potential filter</p>
</dd>
<dt><a class="reference internal" href="../_autosummary_bak/tools.maths.filter_savitzkygolay.html#tools.maths.filter_savitzkygolay" title="tools.maths.filter_savitzkygolay"><code class="xref py py-meth docutils literal notranslate"><span class="pre">tools.maths.filter_savitzkygolay()</span></code></a></dt><dd><p>Potential filter</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="signalanalysis.egm.Egm.calculate_dvdt">
<code class="sig-name descname">calculate_dvdt</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">time_points</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>Union<span class="p">[</span>float<span class="p">, </span>List<span class="p">[</span>float<span class="p">]</span><span class="p">, </span>pandas.core.frame.DataFrame<span class="p">]</span><span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">dvdt_normalise</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em>, <em class="sig-param"><span class="n">dvdt_rescale</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#signalanalysis.egm.Egm.calculate_dvdt" title="Permalink to this definition">¶</a></dt>
<dd><p>Return dV/dt values at specified time points</p>
<p>TODO: Write this function, if useful - currently simpler to just calculate dV/dt for AT directly in method</p>
<p>Will return the value of dV/dt at specified time points.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time_points</strong> (<em>list of float</em>) – List of time points at which to calculate dV/dt for the signal</p></li>
<li><p><strong>dvdt_normalise</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to normalise the ECG trace to a [-1, 1] range prior to calculating the dVdt value - will only adjust
the values relative to a maximum, and not necessarily rescale within the entire range, i.e. an EGM from [0,
10] will rescale to [0, 1]. This will not affect any other part of the calculations, default=False</p></li>
<li><p><strong>dvdt_rescale</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to normalise the ECG trace to a [-1, 1] range prior to calculating the dVdt value - will adjust
the values relative cover the entire new range, i.e. an EGM from [0, 10] will rescale to [-1,
1]. This will not affect any other part of the calculations, default=false</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>self.dvdt</strong> – dV/dt values for each point of the AT</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="../_autosummary_bak/signalanalysis.egm.Egm.html#id0" title="signalanalysis.egm.Egm.get_at"><code class="xref py py-meth docutils literal notranslate"><span class="pre">signalanalysis.egm.Egm.get_at()</span></code></a></dt><dd><p>Method used to calculate AT, that uses this method implicitly</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="signalanalysis.egm.Egm.get_ari">
<code class="sig-name descname">get_ari</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">plot</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#signalanalysis.egm.Egm.get_ari" title="Permalink to this definition">¶</a></dt>
<dd><p>Dummy function to calculate ARI</p>
<p>TODO: check that <cite>plot</cite> keyword is correctly over-ridden (if that is possible)</p>
<p>ARI is calculated as part of self.get_rt, so this module serves just as useful syntax.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="../_autosummary_bak/signalanalysis.egm.Egm.html#signalanalysis.egm.Egm.get_rt" title="signalanalysis.egm.Egm.get_rt"><code class="xref py py-meth docutils literal notranslate"><span class="pre">signalanalysis.egm.Egm.get_rt()</span></code></a></dt><dd><p>Actual method called</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="id0">
<code class="sig-name descname">get_at</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">at_window</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">30</span></em>, <em class="sig-param"><span class="n">unipolar_delay</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">50</span></em>, <em class="sig-param"><span class="n">plot</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#id0" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the activation time for a given beat of EGM data</p>
<p>Will calculate the activation times for an EGM signal, based on finding the peaks in the squared bipolar
trace, then finding the maximum downslope in the unipolar signal within a specified window of time around
those peaks. Note that, if bipolar data are not present, then the squared unipolar signal will be used,
which will invariably find the pacing artefact. As such, when unipolar peaks are used, a ‘delay’ will be
applied to the window to avoid the pacing artefact.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>at_window</strong> (<em>float</em><em>, </em><em>optional</em>) – Time in milliseconds, around which the activation time will be searched for round the detected peaks,
i.e. the EGM trace will be searched in the window t_peak +/- at_window. Default=30ms</p></li>
<li><p><strong>unipolar_delay</strong> (<em>float</em><em>, </em><em>optional</em>) – Time in milliseconds to delay the search window after the peak time, if only unipolar data are being
used, to avoid getting confused with the far-field pacing artefact. Will thus have the search window
adapted to (t_peak+unipolar_delay) +/- at_window. Default=50ms</p></li>
<li><p><strong>plot</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to plot a random signal example of the ATs found, default=False</p></li>
</ul>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="../_autosummary_bak/signalanalysis.egm.Egm.html#signalanalysis.egm.Egm.get_peaks" title="signalanalysis.egm.Egm.get_peaks"><code class="xref py py-meth docutils literal notranslate"><span class="pre">signalanalysis.egm.Egm.get_peaks()</span></code></a></dt><dd><p>Method to calculate peaks</p>
</dd>
<dt><code class="xref py py-meth docutils literal notranslate"><span class="pre">signalanalysis.egm.Egm.plot_signal()</span></code></dt><dd><p>Method to plot the signal</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="signalanalysis.egm.Egm.get_beats">
<code class="sig-name descname">get_beats</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">reset_index</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">True</span></em>, <em class="sig-param"><span class="n">offset_start</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>float<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">offset_end</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>float<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">plot</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#signalanalysis.egm.Egm.get_beats" title="Permalink to this definition">¶</a></dt>
<dd><p>Detects beats in individual EGM signals</p>
<p>TODO: Replace this with method based on finding AT and RT, then adding buffer round those values</p>
<p>Supermethod for EGM beat detection, due to the fact that EGM beats are detected on a per signal basis
rather than  a universal basis (RMS method)</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="../_autosummary_bak/signalanalysis.general.Signal.html#signalanalysis.general.Signal.get_beats" title="signalanalysis.general.Signal.get_beats"><code class="xref py py-meth docutils literal notranslate"><span class="pre">signalanalysis.general.Signal.get_beats()</span></code></a></dt><dd><p>Base method</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="signalanalysis.egm.Egm.get_peaks">
<code class="sig-name descname">get_peaks</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">threshold</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">0.33</span></em>, <em class="sig-param"><span class="n">min_separation</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">200</span></em>, <em class="sig-param"><span class="n">plot</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#signalanalysis.egm.Egm.get_peaks" title="Permalink to this definition">¶</a></dt>
<dd><p>Supermethod for get_peaks for EGM data, using the squared bipolar signal rather than RMS data</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-meth docutils literal notranslate"><span class="pre">signalanalysis.egm.Egm.plot_signal()</span></code></dt><dd><p>Method to plot the calculated AT</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="signalanalysis.egm.Egm.get_qrsd">
<code class="sig-name descname">get_qrsd</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">lower_window</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">30</span></em>, <em class="sig-param"><span class="n">upper_window</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">60</span></em>, <em class="sig-param"><span class="n">threshold</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">0.1</span></em>, <em class="sig-param"><span class="n">plot</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">True</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#signalanalysis.egm.Egm.get_qrsd" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the QRS duration for EGM data</p>
<p>TODO: See if this can be improved beyond the current brute force method</p>
<p>The start and end of the QRS complex is calculated as the duration for which the energy of the bipolar signal
(defined as the bipolar signal squared) exceeds a threshold value. The ‘window’ over which to search for this
complex is defined from the detected activation times, plus/minus specified values (<cite>lower_window</cite> and
<cite>upper_window</cite>). Note that, due to the calculation method, this cannot be calculated for instances where no
bipolar data are available.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lower_window</strong> (<em>float</em><em>, </em><em>optional</em>) – Window before/after AT to search for QRS start/end, respectively, given in milliseconds, default=30/60ms</p></li>
<li><p><strong>upper_window</strong> (<em>float</em><em>, </em><em>optional</em>) – Window before/after AT to search for QRS start/end, respectively, given in milliseconds, default=30/60ms</p></li>
<li><p><strong>threshold</strong> (<em>float</em><em>, </em><em>optional</em>) – Fractional threshold of maximum energy used to define the start and end of the QRS complex, default=0.1</p></li>
<li><p><strong>plot</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether or not to plot an example trace</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>self.qrs_duration</strong> – QRS durations for each signal</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="../_autosummary_bak/signalanalysis.egm.Egm.html#id0" title="signalanalysis.egm.Egm.get_at"><code class="xref py py-meth docutils literal notranslate"><span class="pre">signalanalysis.egm.Egm.get_at()</span></code></a></dt><dd><p>Method used to calculate AT, that uses this method implicitly</p>
</dd>
<dt><a class="reference internal" href="../_autosummary_bak/signalplot.egm.plot_signal.html#signalplot.egm.plot_signal" title="signalplot.egm.plot_signal"><code class="xref py py-meth docutils literal notranslate"><span class="pre">signalplot.egm.plot_signal()</span></code></a></dt><dd><p>Plotting function, with options that can be passed in <a href="#id1"><span class="problematic" id="id2">**</span></a>kwargs</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="signalanalysis.egm.Egm.get_rms">
<code class="sig-name descname">get_rms</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">preprocess_data</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>pandas.core.frame.DataFrame<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">drop_columns</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>List<span class="p">[</span>str<span class="p">]</span><span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#signalanalysis.egm.Egm.get_rms" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the RMS of the combined signal</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>preprocess_data</strong> (<em>pd.DataFrame</em><em>, </em><em>optional</em>) – Only passed if there is some extant data that is to be used for getting the RMS (for example,
if the unipolar data only from ECG is being used, and the data is thus preprocessed in a manner specific
for ECG data in the ECG routine)</p></li>
<li><p><strong>drop_columns</strong> (<em>list of str</em><em>, </em><em>optional</em>) – List of any columns to drop from the raw data before calculating the RMS. Can be used in conjunction with
preprocess_data</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>self.rms</strong> – RMS signal of all combined leads</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pd.Series</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The scalar RMS is calculated according to</p>
<div class="math notranslate nohighlight">
\[\sqrt{ \frac{1}{n}\sum_{i=1}^n (\textnormal{ECG}_i^2(t)) }\]</div>
<p>for all leads available from the signal (12 for ECG, 3 for VCG), unless some leads are excluded via the
drop_columns parameter.</p>
</dd></dl>

<dl class="py method">
<dt id="signalanalysis.egm.Egm.get_rt">
<code class="sig-name descname">get_rt</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">lower_window_limit</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">140</span></em>, <em class="sig-param"><span class="n">plot</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#signalanalysis.egm.Egm.get_rt" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the repolarisation time</p>
<p>Calculates the repolarisation time of an action potential from the EGM, based on the Wyatt method of the
maximum upslope of the T-wave</p>
<p>TODO: try to improve on the current brute force method used to find the point of RT</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lower_window_limit</strong> (<em>float</em><em>, </em><em>optional</em>) – Minimum time after the AT to have passed before repolarisation can potentially happen, default=150ms</p></li>
<li><p><strong>plot</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to plot a random signal example of the ATs found, default=False</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>self.rt</strong> (<em>pd.DataFrame</em>) – Repolarisation times for each signal in the trace</p></li>
<li><p><strong>self.ari</strong> (<em>pd.DataFrame</em>) – Activation repolarisation intervals for each AT/RT pair</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">References</p>
<dl class="footnote brackets">
<dt class="label" id="id3"><span class="brackets">1</span></dt>
<dd><p>Porter B, Bishop MJ, Claridge S, Behar J, Sieniewicz BJ, Webb J, Gould J, O’Neill M, Rinaldi CA,
Razavi R, Gill JS, Taggart P, “Autonomic modulation in patients with heart failure increases
beat-to-beat variability of ventricular action potential duration. Frontiers in Physiology, 8(MAY 2017).
<a class="reference external" href="https://doi.org/10.3389/fphys.2017.00328">https://doi.org/10.3389/fphys.2017.00328</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="signalanalysis.egm.Egm.plot_beats">
<code class="sig-name descname">plot_beats</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">offset_end</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>float<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">i_plot</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>int<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#signalanalysis.egm.Egm.plot_beats" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>..deprecated::</dt><dd><p>Need to move this to signalplot.egm (if this even works!)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="id4">
<code class="sig-name descname">read</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data_location_uni</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">data_location_bi</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>str<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">drop_empty_rows</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">True</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#id4" title="Permalink to this definition">¶</a></dt>
<dd><p>Read the DxL data for unipolar and bipolar data for EGMs</p>
<p>TODO: Add functionality to read directly from folders, rather than .csv from Matlab</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_location_uni</strong> (<em>str</em>) – Location of unipolar data. Currently only coded to deal with a saved .csv file</p></li>
<li><p><strong>data_location_bi</strong> (<em>str</em><em>, </em><em>optional</em>) – Location of bipolar data. Currently only coded to deal with a saved .csv file. Doesn’t need to be passed,
default=None</p></li>
<li><p><strong>drop_empty_rows</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to drop empty data rows from the data, default=True</p></li>
</ul>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="../_autosummary_bak/signalanalysis.egm.Egm.html#signalanalysis.egm.Egm.read_from_csv" title="signalanalysis.egm.Egm.read_from_csv"><code class="xref py py-meth docutils literal notranslate"><span class="pre">signalanalysis.egm.Egm.read_from_csv()</span></code></a></dt><dd><p>Method to read data from Matlab csv</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="signalanalysis.egm.Egm.read_from_csv">
<code class="sig-name descname">read_from_csv</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data_location_uni</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">data_location_bi</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>str<span class="p">]</span></span></em>, <em class="sig-param"><span class="n">frequency</span><span class="p">:</span> <span class="n">float</span></em><span class="sig-paren">)</span><a class="headerlink" href="#signalanalysis.egm.Egm.read_from_csv" title="Permalink to this definition">¶</a></dt>
<dd><p>Read EGM data that has been saved from Matlab</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_location_uni</strong> (<em>str</em>) – Name of the .csv file containing the unipolar data</p></li>
<li><p><strong>data_location_bi</strong> (<em>str</em><em>, </em><em>optional</em>) – Name of the .csv file containing the bipolar data</p></li>
<li><p><strong>frequency</strong> (<em>float</em>) – The frequency of the data recording in Hz</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>It is not technically required to pass the bipolar data, but it is presented here as a required keyword to
preserve the usage of calling as <cite>read_from_csv(unipolar, bipolar, frequency)</cite>, rather than breaking the data
files arguments up or requiring keywords.</p>
<p>The .csv file should be saved with column representing an individual EGM trace, and each row representing a
single instance in time, i.e.</p>
<p>Historically, <cite>frequency</cite> has been set to 2034.5 Hz for the importprecision data, an example of which is
saved in <code class="docutils literal notranslate"><span class="pre">tests/egm_unipolar.csv</span></code> and <code class="docutils literal notranslate"><span class="pre">tests/egm_bipolar.csv</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt id="signalanalysis.egm.Egm.reset">
<code class="sig-name descname">reset</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#signalanalysis.egm.Egm.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset all properties of the class</p>
<p>Function called when reading in new data into an existing class (for some reason), which would make these
properties and attributes clash with the other data</p>
</dd></dl>

<dl class="py method">
<dt id="signalanalysis.egm.Egm.return_to_index">
<code class="sig-name descname">return_to_index</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">original_sequence</span><span class="p">:</span> <span class="n">Union<span class="p">[</span>pandas.core.frame.DataFrame<span class="p">, </span>list<span class="p">, </span>float<span class="p">, </span>int<span class="p">]</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#signalanalysis.egm.Egm.return_to_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Aligns a given sequence of time values to those in the index</p>
<p>When manipulating time data, it can often fall out of sync with the time values for the data, e.g. the data
are recorded every 2ms, then searching for a value at 5ms will be difficult. This function realigns a
sequence of time data to the possible values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>original_sequence</strong> (<em>pd.DataFrame</em><em> or </em><em>list</em><em> or </em><em>float</em><em> or </em><em>int</em>) – The sequence of numbers to be returned to the correct time index</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>new_sequence</strong> – The sequence of numbers now corrected to match the time index for the data, returned in the same format
as the original sequence was provided, i.e. pd.DataFrame will return pd.DataFrame, int will return int,
and so on.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pd.DataFrame or list or float or int</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">signalanalysis</a></h1>








<h3>Navigation</h3>
<p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../usage.html">Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../signalanalysis.html">Signal Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../signalplot.html">Signal Plot</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../docutils.html">docutils Documentation</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="signalanalysis.html">signalanalysis</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="signalanalysis.ecg.html">signalanalysis.ecg</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="signalanalysis.egm.html">signalanalysis.egm</a></li>
<li class="toctree-l3"><a class="reference internal" href="signalanalysis.general.html">signalanalysis.general</a></li>
<li class="toctree-l3"><a class="reference internal" href="signalanalysis.vcg.html">signalanalysis.vcg</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="signalplot.html">signalplot</a></li>
<li class="toctree-l2"><a class="reference internal" href="tools.html">tools</a></li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="../docutils.html">docutils Documentation</a><ul>
  <li><a href="signalanalysis.html">signalanalysis</a><ul>
  <li><a href="signalanalysis.egm.html">signalanalysis.egm</a><ul>
      <li>Previous: <a href="signalanalysis.egm.html" title="previous chapter">signalanalysis.egm</a></li>
      <li>Next: <a href="signalanalysis.general.html" title="next chapter">signalanalysis.general</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2022, Philip Gemmell.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 3.4.3</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/_autosummary/signalanalysis.egm.Egm.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>